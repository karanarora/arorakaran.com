<!DOCTYPE html>
<html>
<head>
  <title>Rashmi Yadav</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <link href="/stylesheets/bootstrap.css?1349946655" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/bootstrap-responsive.css?1349946655" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/style.css?1349946655" media="screen" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/main.css?1349946655" media="screen" rel="stylesheet" type="text/css" />
  <script src="/javascripts/bootstrap.js?1349946655" type="text/javascript"></script>
</head><body>
<div class="container">
  <div id='header' class="row">
  <h1>Rashmi Yadav</h1>
</div>
  <div class="main_box">
    <div class="content">
      <div id="main" role="main">
        <article>
          <h2 style="padding-bottom: 10px;">
            <span class="color-orange">Background Processing Using Rails Runner</span>
            <span>May  3 2012</span>
            <!--<span><a href="https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Fraysrashmi.com%2F&amp;source=tweetbutton&amp;text=Polymorphic%20Association%20with%20has_many%20%3Athrough&amp;url=http%3A%2F%2Fraysrashmi.com%2F2012%2F06%2Fpolymorphic-association-has_many-through%2F&amp;via=raysrashmi" class="btn" id="b" target="_blank"><i></i><span class="label" id="l">Tweet</span></a></span>-->
          </h2>
          <div class="post">
            <p>Rails comes with a built-in tool for running tasks independent of the web cycle. The <code>rails runner</code> command simply loads the default Rails environment and then executes some specified Ruby code.</p>



Some of use cases :
<ol>
  <li>Data import</li>
  <li>Execute methods of your models.</li>
  <li>Sending batch emails</li>
  <li>Nightly report generation</li>
</ol>

<p>Showing here some code example for</p>

<p>Let's say you want to generate a nightly report and send it out to multiple users</p>

<pre class="brush:ruby">
rails runner DailyReport.send_me!
</pre>

<p>This will execute <code> send_me! </code> method for <code> DailyReport </code> class.</p>

<p><code> rails runner </code> will give us access to all rails environment so we can even use the Active Record finder methods to extract data from our application.</p>

<pre class="brush:ruby">
rails runner 'User.all.map(&:email).each {|e| puts e }'
</pre>

<p>Here we are just listing out emails of all users in our system.</p>

<pre class="brush:ruby">
rails runner -h
</pre>

<p>Output will be</p>

<pre class="brush:ruby">
Usage: runner [options] ('Some.ruby(code)' or a filename)

    -e, --environment=name           Specifies the environment for the runner to operate under (test/development/production).
                                     Default: development

    -h, --help                       Show this help message.

You can also use runner as a shebang line for your scripts like this:
-------------------------------------------------------------
#!/usr/bin/env /Users/raysrashmi/checkouts/foobar/script/rails runner

Product.find(:all).each { |p| p.price *= 2 ; p.save! }
-------------------------------------------------------------
</pre>

A sample crontab to run that script might look like

<pre class="brush:ruby">
  @daily  /Users/raysrashmi/checkouts/foobar/script/rails runner -e production 'DailyReport.send_me!'
</pre>

<p>This script will run daily to send out daily report.

The Rails Runner is useful for short tasks that need to run infrequently.

But jobs that require more heavy work are best handled by other libraries.

I use <code> rails runner </code> whenever I need to run a small task.
</p>
Reference links :
<ul>
  <li><a href="http://www.ameravant.com/posts/recurring-tasks-in-ruby-on-rails-using-runner-and-cron-jobs">http://www.ameravant.com/posts/recurring-tasks-in-ruby-on-rails-using-runner-and-cron-jobs</a></li>
</ul>


There are other better library available for handling background process. But here I wanted to talk about <code>rails runner</code>
          </div>
          <hr/>
          <div id="disqus_thread"></div>
          <script type="text/javascript">
              $(function(){
                  hljs.initHighlightingOnLoad();
                  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                  var disqus_shortname = 'rays'; // required: replace example with your forum shortname

                  /* * * DON'T EDIT BELOW THIS LINE * * */
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
              });
          </script>
          <noscript>
            Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
          </noscript>
          <a href="http://disqus.com" class="dsq-brlink">
            blog comments powered by <span class="logo-disqus">Disqus</span>
          </a>
        </article>
      </div>
    </div>
    <div class='right_side' xmlns="http://www.w3.org/1999/html">
	<h2>
		<a href="/about"><img src="/images/me.jpeg">
          <div style="font-size: 14px;">About</div>
        </a>
	</h2>
	<hr>
	<p>
      <a href="https://github.com/rashmi14yadav"><img src="/images/github-icon.png" class='github'></a>
      <a href="http://twitter.com/raysrashmi"><img src="/images/twitter.png" class='github'></a>
    </p>
    <hr>

  <h2>Articles</h2>
    <ol class='font14'>
      
        <li><a href="/2012/06/07/polymorphic-association-has_many-through.html">Polymorphic Association with has_many :through</a> <span>Jun  7 2012</span></li>
      
        <li><a href="/2012/05/05/enhance-rails-models.html">Enhance Rails Models</a> <span>May  5 2012</span></li>
      
        <li><a href="/2012/05/03/background-processing-using-rails-runner.html">Background Processing Using Rails Runner</a> <span>May  3 2012</span></li>
      
        <li><a href="/2012/05/01/rails-3-responders.html">Rails 3 Responders</a> <span>May  1 2012</span></li>
      
        <li><a href="/2012/04/22/oauth-omniauth-github.html">OAuth with OmniAuth and Github</a> <span>Apr 22 2012</span></li>
      
        <li><a href="/2012/02/19/basic-difference-between-proc-and-lambda-in-ruby.html">Basic Difference between Proc and Lambda in Ruby</a> <span>Feb 19 2012</span></li>
      
        <li><a href="/2012/02/18/call-proc-in-ruby-1-9.3.html">Proc call in ruby1.9.3</a> <span>Feb 18 2012</span></li>
      
        <li><a href="/2011/11/29/asset-pipeline.html">Asset Pipeline with Rails 3.1</a> <span>Nov 29 2011</span></li>
      
        <li><a href="/2011/05/15/jquery-datetime-picker.html">jQuery Date/Time picker</a> <span>May 15 2011</span></li>
      
        <li><a href="/2010/12/31/twitter-client-script-to-retrieves-all-the-unique-http-links-in-the-last-recent-tweets.html">Twitter Client script to retrieves all the unique http links in the last recent tweets</a> <span>Dec 31 2010</span></li>
      
        <li><a href="/2010/12/21/include-class-method-and-validation-using-module-in-rubyonrails.html">Include Class Method and Validation  Using Module in RubyOnRails</a> <span>Dec 21 2010</span></li>
      
        <li><a href="/2010/12/04/routes-in-rails3.html">Routes in Rails3</a> <span>Dec  4 2010</span></li>
      
        <li><a href="/2010/11/24/activemodel-in-rails3-table-less-model-can-behave-like-active-record-model.html">ActiveModel in Rails3</a> <span>Nov 24 2010</span></li>
      
        <li><a href="/2010/08/02/extended-version-of-active-merchant-plugin.html">Extended Version of Active Merchant Plugin</a> <span>Aug  2 2010</span></li>
      
    </ol>
    <hr>
  <h2>Tags</h2>
    <ol>
      
        <li><a href="tags/activemerchant.html">ActiveMerchant (1)</a></li>
      
        <li><a href="tags/paymentgatewayplugin.html">PaymentGatewayPlugin (1)</a></li>
      
        <li><a href="tags/activemodel.html">ActiveModel (1)</a></li>
      
        <li><a href="tags/rails.html">Rails (3)</a></li>
      
        <li><a href="tags/routes-in-rails3.html">Routes in Rails3 (1)</a></li>
      
        <li><a href="tags/routes.html">Routes (1)</a></li>
      
        <li><a href="tags/modules.html">Modules (1)</a></li>
      
        <li><a href="tags/twitter.html">Twitter (1)</a></li>
      
        <li><a href="tags/client-script.html">Client Script (1)</a></li>
      
        <li><a href="tags/date-time-picker.html">date/time picker (1)</a></li>
      
        <li><a href="tags/jquery.html">jQuery (1)</a></li>
      
        <li><a href="tags/asset-pipeline.html">Asset Pipeline (1)</a></li>
      
        <li><a href="tags/rails3.html">Rails3 (2)</a></li>
      
        <li><a href="tags/proc-in-ruby.html">Proc In Ruby (1)</a></li>
      
        <li><a href="tags/ruby.html">Ruby (3)</a></li>
      
        <li><a href="tags/proc.html">Proc (1)</a></li>
      
        <li><a href="tags/lambda.html">Lambda (1)</a></li>
      
        <li><a href="tags/github.html">Github (1)</a></li>
      
        <li><a href="tags/oauth.html">OAuth (1)</a></li>
      
        <li><a href="tags/omniauth.html">OmniAuth (1)</a></li>
      
        <li><a href="tags/railsresponders.html">RailsResponders (1)</a></li>
      
        <li><a href="tags/railsrunner.html">RailsRunner (1)</a></li>
      
        <li><a href="tags/backgroundtask.html">Backgroundtask (1)</a></li>
      
        <li><a href="tags/rubyonrails.html">RubyOnRails (1)</a></li>
      
        <li><a href="tags/activerecord.html">activerecord (2)</a></li>
      
        <li><a href="tags/association.html">association (2)</a></li>
      
        <li><a href="tags/polymorphic.html">polymorphic (2)</a></li>
      
    </ol>
  <a href="http://coderwall.com/rashmi14yadav"><img alt="Endorse rashmi14yadav on Coderwall" src="http://api.coderwall.com/rashmi14yadav/endorsecount.png" /></a>
</div>

  </div>
</div>
</body>
</html>